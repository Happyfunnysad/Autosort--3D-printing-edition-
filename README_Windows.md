# Автосортировка 3D-файлов на Windows

Автоматическая сортировка файлов для 3D-печати из папки Загрузки в отдельную папку. Скрипт проверяет расширения файлов (STL, OBJ, 3MF и др.) и автоматически перемещает их.

## Возможности

- ✅ Автоматическое перемещение файлов для 3D-печати
- ✅ Поддержка папок (проверяет содержимое рекурсивно)
- ✅ Интеграция с Планировщиком заданий Windows
- ✅ Подробное логирование
- ✅ Безопасное перемещение (не перезаписывает существующие файлы)

## Поддерживаемые форматы

- STL
- OBJ
- 3MF
- GCODE
- LYS
- CTB

Вы можете добавить свои форматы в файл `config.bat`.

## Установка

### Быстрая установка

1. Откройте командную строку (cmd) или PowerShell от имени администратора
2. Перейдите в папку проекта:
```cmd
cd "C:\path\to\3d print sort"
```

3. Запустите скрипт установки:
```cmd
setup.bat
```

Скрипт установки автоматически:
- Создаст целевую папку для 3D-файлов
- Настроит задачу в Планировщике заданий для автоматического запуска каждые 5 минут

## Настройка

Отредактируйте файл `config.bat` для изменения настроек:

```cmd
notepad config.bat
```

### Основные параметры:

- `SOURCE_DIR` - папка, которую нужно отслеживать (по умолчанию: `%USERPROFILE%\Downloads`)
- `TARGET_DIR` - папка назначения (по умолчанию: `%USERPROFILE%\Documents\3D_Models`)
- `EXTS` - список расширений файлов через пробел (например: `stl obj 3mf`)
- `ENABLE_SOURCE_FILTER` - включить фильтрацию по источнику (`true`/`false`)
- `LOG_FILE` - путь к файлу лога

### Примеры настройки

#### Изменение целевой папки:
```batch
set "TARGET_DIR=D:\3D_Printing\Models"
```

#### Добавление новых форматов:
```batch
set "EXTS=stl obj 3mf gcode lys ctb ply amf"
```

## Использование

### Автоматический режим

После установки скрипт будет автоматически запускаться через Планировщик заданий. Просто скачайте файл в папку Загрузки, и он будет перемещен в течение нескольких минут.

### Ручной запуск

Для немедленной проверки и сортировки:
```cmd
sort_3d.bat
```

### Просмотр логов

```cmd
REM Просмотр последних записей
type %TEMP%\sort_3d.log

REM Открыть в блокноте
notepad %TEMP%\sort_3d.log
```

## Управление Планировщиком заданий

### Просмотр задачи:
```cmd
schtasks /query /tn "AutoSort3DFiles"
```

### Удаление задачи:
```cmd
schtasks /delete /tn "AutoSort3DFiles" /f
```

### Изменение расписания:
1. Откройте **Планировщик заданий** (Task Scheduler)
2. Найдите задачу **AutoSort3DFiles**
3. Щелкните правой кнопкой → **Свойства**
4. Измените триггеры по необходимости

## Решение проблем

### Скрипт не перемещает файлы

1. **Проверьте права доступа:**
   - Убедитесь, что скрипт запускается с правами, достаточными для чтения/записи файлов
   - Проверьте, что целевая папка существует и доступна

2. **Проверьте логи:**
   ```cmd
   type %TEMP%\sort_3d.log
   ```

3. **Проверьте конфигурацию:**
   - Убедитесь, что пути в `config.bat` правильные
   - Проверьте, что целевая папка существует

4. **Проверьте Планировщик заданий:**
   ```cmd
   schtasks /query /tn "AutoSort3DFiles"
   ```
   Убедитесь, что задача присутствует и включена

### Файлы не перемещаются

- Убедитесь, что расширения файлов указаны в `EXTS` в `config.bat`
- Проверьте, что файлы находятся в правильной исходной папке
- Убедитесь, что файлы не открыты в других программах

### Скрипт работает медленно

- Уменьшите частоту запуска в Планировщике заданий
- Убедитесь, что в папке Загрузки не слишком много файлов

## Ограничения Windows

В отличие от версии для macOS:
- ❌ Проверка источника скачивания ограничена (Windows использует Zone.Identifier, который менее информативен)
- ❌ Нет цветных меток файлов (это функция macOS Finder)
- ✅ Все остальные функции работают аналогично

## Структура проекта

```
3d print sort/
├── sort_3d.bat      # Основной скрипт сортировки (Windows)
├── config.bat       # Файл конфигурации (Windows)
├── setup.bat        # Скрипт установки (Windows)
├── sort_3d.sh       # Основной скрипт сортировки (macOS/Linux)
├── config.sh        # Файл конфигурации (macOS/Linux)
├── setup.sh         # Скрипт установки (macOS/Linux)
├── README.md        # Инструкция для macOS
└── README_Windows.md # Эта инструкция
```

## Безопасность

- Скрипт использует безопасное перемещение, которое не перезаписывает существующие файлы
- Все действия логируются в `%TEMP%\sort_3d.log`
- Скрипт не удаляет файлы, только перемещает их

## Лицензия

Свободное использование. Модифицируйте под свои нужды.

## Поддержка

При возникновении проблем:
1. Проверьте логи: `type %TEMP%\sort_3d.log`
2. Убедитесь, что все настройки в `config.bat` корректны
3. Проверьте задачу в Планировщике заданий

